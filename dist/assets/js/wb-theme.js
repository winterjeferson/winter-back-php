class Blog{constructor(){this.cssLoadMore="loadMore",this.cssLoadMoreSelector=`[data-id="${this.cssLoadMore}"]`,this.cssDisabled="button--blue--disabled"}build(){window.helper.getUrlWord("blog")&&(this.update(),this.buildMenu())}update(){this.page="pageBlog",this.elLastPost=document.querySelector(`#${this.page}LastPost`),this.elMostViewed=document.querySelector(`#${this.page}MostViewed`)}buildMenu(){if(!this.elLastPost||!this.elMostViewed)return;const e=this.elLastPost.querySelector(this.cssLoadMoreSelector),t=this.elMostViewed.querySelector(this.cssLoadMoreSelector);document.contains(e)&&e.addEventListener("click",()=>{this.loadMore(e)}),document.contains(t)&&t.addEventListener("click",()=>{this.loadMore(t)})}loadMore(e){const t=e.parentNode.parentNode.getAttribute("id"),o=t.substring(this.page.length),s={controller:window.wbUrl.getController({folder:"blog",file:"LoadMore"}),parameter:`&target=${o}`};let l=wbHelper.ajax(s);e.classList.add(this.cssDisabled),l.then(o=>{e.classList.remove(this.cssDisabled),this.loadMoreSuccess(t,o)})}loadMoreSuccess(e,t){const o=JSON.parse(t),s=document.querySelector(`#${e}`),l=s.querySelector(".blog-list"),r=s.querySelector(`[data-id="${this.cssLoadMore}"]`);o[this.cssLoadMore]||r.classList.add(this.cssDisabled),l.insertAdjacentHTML("beforeend",o.html),window.scrollTo(0,document.documentElement.scrollTop+1),window.scrollTo(0,document.documentElement.scrollTop-1)}}export{Blog};class Form{constructor(){this.cssDisabled="button--blue--disabled"}build(){window.helper.getUrlWord("form")&&(this.update(),this.buildMenu())}update(){this.elPage=document.querySelector("#pageForm"),this.elForm=this.elPage.querySelector(".form"),this.elFormFieldEmail=this.elForm.querySelector('[data-id="email"]'),this.elFormFieldMessage=this.elForm.querySelector('[data-id="message"]'),this.elButtonSend=this.elPage.querySelector("#pageFormBtSend")}buildMenu(){this.elButtonSend.addEventListener("click",()=>{window.form.validateEmpty([this.elFormFieldEmail,this.elFormFieldMessage])&&this.send()})}send(){const e=JSON.stringify(this.getData()),t={controller:window.wbUrl.getController({folder:"form",file:"FormAjax"}),parameter:"&method=sendForm"+`&data=${e}`};let o=wbHelper.ajax(t);this.elButtonSend.classList.add(this.cssDisabled),o.then(e=>{this.sendSuccess(e)})}sendSuccess(e){let t="",o="";switch(this.elButtonSend.classList.remove(this.cssDisabled),e){case"ok":o="green",t=globalTranslation.formSent;break;default:o="red",t=globalTranslation.formProblemSend}window.notification.add({text:t,color:o})}getData(){let e=[];return e.push(this.elForm.querySelector('[data-id="email"]').value),e.push(this.elForm.querySelector('[data-id="message"]').value),e}}export{Form};class Helper{ajax(e){return new Promise((t,o)=>{const s=void 0===e.kind?"POST":e.kind,l=`${e.parameter}&token=${globalToken}`,r=e.controller;let a=new XMLHttpRequest;a.open(s,r,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onload=(()=>{a.status>=200&&a.status<300?t(a.responseText):o(a.statusText)}),a.onerror=(()=>o(a.statusText)),a.send(l)})}}export{Helper};class Translation{build(){this.update(),this.defineActive(),this.buildMenu()}buildMenu(){this.elSelect.addEventListener("change",e=>{const t=e.target.options.selectedIndex,o=e.target.options[t].getAttribute("data-url");window.location.replace(o)})}defineActive(){this.elSelect.value=globalLanguage}update(){this.elSelect=document.querySelector("#translationSelect")}}export{Translation};class Url{buildSEO(e){return e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"-").toLowerCase().replace(/&/g,"-and-").replace(/[^a-z0-9\-]/g,"").replace(/-+/g,"-").replace(/^-*/,"").replace(/-*$/,"")}buildUrl(e){window.location=`${globalUrl+globalLanguage}/${e}/`}getController(e){return`./app/controller/${e.folder}/${e.file}.php`}watch(e,t){e.addEventListener("focusout",()=>{t.value=this.buildSEO(e.value)})}}export{Url};window.wbUrl=new Url,window.wbHelper=new Helper;const blog=new Blog,form=new Form,translation=new Translation;document.addEventListener("DOMContentLoaded",()=>{translation.build(),blog.build(),form.build()});