class Admin{constructor(){this.pageCurrent="",this.cssActive="tab--active",this.cssWrapper="table-td-wrapper",this.idPage="mainContent",this.idButton="button_admin_"}build(){window.helper.getUrlWord("admin")&&(this.update(),this.buildMenuActive(),this.wrappTable())}buildMenuActive(){const e=window.location.href.split("/"),t=e[e.length-2],i=this.elPage.querySelector(`[data-id="${this.idButton+t}"]`);null!==i&&i.classList.add(this.cssActive)}setCKEditor(){CKEDITOR.replace("fieldContent",{}),CKEDITOR.config.basicEntities=!1,CKEDITOR.config.entities_greek=!1,CKEDITOR.config.entities_latin=!1,CKEDITOR.config.entities_additional=""}showResponse(e){let t="",i="";switch(e){case"done":location.reload();break;case"problemPermission":t="red",i=globalTranslation.problemPermission;default:t="red",i=globalTranslation.errorAdministrator}window.notification.add({text:i,color:t})}update(){this.elPage=document.querySelector(`#${this.idPage}`)}wrappTable(){const e=document.querySelectorAll(`.${this.cssWrapper}`);Array.prototype.forEach.call(e,e=>{e.onclick=(()=>{e.classList.contains(this.cssWrapper)?e.classList.remove(this.cssWrapper):e.classList.add(this.cssWrapper)})})}}export{Admin};class AdminBlog{build(){window.helper.getUrlWord("admin/blog")&&(admin.setCKEditor(),this.update(),this.buildMenu(),this.buildMenuTable(),this.buildMenuThumbnail(),window.wbUrl.watch(this.elFormFieldTitle,this.elFormFieldUrl))}buildMenu(){this.elButtonRegister.onclick=(()=>{this.validateForm()&&(this.isEdit?this.editSave():this.saveContent())})}buildMenuThumbnail(){const e=this.elContentEditThumbnail.querySelectorAll(".table");Array.prototype.forEach.call(e,e=>{this.buildMenuThumbnailButton(e)})}buildMenuThumbnailButton(e){const t=e.querySelectorAll('[data-action="edit"]');Array.prototype.forEach.call(t,e=>{e.onclick=(()=>{const e=window.wbUrl.getController({folder:"admin",file:"BlogThumbnail"});window.modal.buildModal({kind:"ajax",content:e,size:"extra-big"})})})}buildMenuTableActive(e){const t=e.querySelectorAll('[data-action="inactivate"]');Array.prototype.forEach.call(t,e=>{e.onclick=(()=>{window.modal.buildModal({kind:"confirmation",content:globalTranslation.confirmationInactivate,size:"small",click:`window.adminBlog.modify(${e.getAttribute("data-id")}, 'inactivate')`})})})}buildMenuTableInactive(e){const t=e.querySelectorAll('[data-action="activate"]');Array.prototype.forEach.call(t,e=>{e.onclick=(()=>{this.modify(e.getAttribute("data-id"),"activate")})})}buildMenuTableDefault(e){const t=e.querySelectorAll('[data-action="edit"]'),i=e.querySelectorAll('[data-action="delete"]');Array.prototype.forEach.call(t,e=>{e.onclick=(()=>{this.editId=e.getAttribute("data-id"),this.editLoadData(this.editId)})}),Array.prototype.forEach.call(i,e=>{e.onclick=(()=>{window.modal.buildModal({kind:"confirmation",content:globalTranslation.confirmationDelete,size:"small",click:`window.adminBlog.delete(${e.getAttribute("data-id")})`})})})}buildMenuTable(){const e=this.elContentList.querySelectorAll(".table"),t=this.elContentList.querySelectorAll('[data-id="tableActive"]'),i=this.elContentList.querySelectorAll('[data-id="tableInactive"]');Array.prototype.forEach.call(t,e=>{this.buildMenuTableActive(e)}),Array.prototype.forEach.call(i,e=>{this.buildMenuTableInactive(e)}),Array.prototype.forEach.call(e,e=>{this.buildMenuTableDefault(e)})}buildParameter(){const e=this.thumbnail===this.thumbnailDefault?"":this.thumbnail;return`&title=${this.elFormFieldTitle.value}`+`&url=${this.elFormFieldUrl.value}`+`&content=${this.elCkEditor.getData()}`+`&datePost=${this.elFormFieldDatePost.value}`+`&dateEdit=${this.elFormFieldDateEdit.value}`+`&authorId=${this.elFormFieldAuthor.value}`+`&thumbnail=${e}`+`&tag=${this.elFormFieldTag.value}`}delete(e){const t="&action=doDelete"+`&id=${e}`,i={controller:this.getController(),parameter:t};wbHelper.ajax(i).then(e=>{admin.showResponse(e)})}editSave(){const e="&action=doUpdate"+`&id=${this.editId}`+this.buildParameter(),t={controller:this.getController(),parameter:e};wbHelper.ajax(t).then(e=>{admin.showResponse(e)})}editLoadData(e){const t="&action=editLoadData"+`&id=${e}`,i={controller:this.getController(),parameter:t};wbHelper.ajax(i).then(e=>{this.editLoadDataSuccess(e)})}editLoadDataSuccess(e){let t=JSON.parse(e);document.documentElement.scrollTop=0,this.isEdit=!0,this.editFillField(t),this.thumbnail=t.thumbnail.trim(),this.modifyThumbnail()}editFillField(e){const t=e[`date_post_${globalLanguage}`],i=e[`date_edit_${globalLanguage}`];this.elFormFieldTitle.value=e[`title_${globalLanguage}`],this.elFormFieldUrl.value=e[`url_${globalLanguage}`],this.elFormFieldTag.value=e[`tag_${globalLanguage}`],this.elFormFieldDatePost.value=null!==t?t.substring(0,10):t,this.elFormFieldDateEdit.value=null!==i?i.substring(0,10):i,this.editId=e.id,this.elFormFieldAuthor.value=e.author_id,this.elCkEditor.setData(e[`content_${globalLanguage}`],()=>{this.elCkEditor.checkDirty()})}getController(){return wbUrl.getController({folder:"admin",file:"BlogAjax"})}modify(e,t){const i="&action=doModify"+`&status=${t}`+`&id=${e}`,l={controller:this.getController(),parameter:i};wbHelper.ajax(l).then(e=>{admin.showResponse(e)})}modifyThumbnail(){const e=this.elThumbnailWrapper.querySelector("table"),t=e.querySelector('[data-id="thumbnail"]'),i=e.querySelector('[data-id="name"]');""===this.thumbnail||null===this.thumbnail?(this.thumbnail=this.thumbnailDefault,this.pathImage=""):this.pathImage=this.pathThumbnail,t.setAttribute("src",`assets/img/${this.pathImage+this.thumbnail}`),i.innerHTML=this.thumbnail}saveContent(){const e="&action=doSave"+this.buildParameter(),t={controller:this.getController(),parameter:e};wbHelper.ajax(t).then(e=>{admin.showResponse(e)})}selectImage(e){const t=e.parentNode.parentNode.querySelector('[data-id="imageName"]').innerText;this.thumbnail=t,window.modal.closeModal(),this.modifyThumbnail()}update(){this.elPage=document.querySelector("#pageAdminBlog"),this.elContentEdit=document.querySelector("#pageAdminBlogEdit"),this.elContentEditThumbnail=this.elContentEdit.querySelector('[data-id="thumbnailWrapper"]'),this.elContentList=document.querySelector("#pageAdminBlogList"),this.elFormRegister=this.elContentEdit.querySelector('[data-id="formRegister"]'),this.elFormFieldTitle=this.elContentEdit.querySelector('[data-id="fieldTitle"]'),this.elFormFieldUrl=this.elContentEdit.querySelector('[data-id="fieldUrl"]'),this.elFormFieldContent=this.elContentEdit.querySelector('[data-id="fieldContent"]'),this.elFormFieldTag=this.elContentEdit.querySelector('[data-id="fieldTag"]'),this.elFormFieldDatePost=this.elContentEdit.querySelector('[data-id="fieldDatePost"]'),this.elFormFieldDateEdit=this.elContentEdit.querySelector('[data-id="fieldDateEdit"]'),this.elThumbnailWrapper=this.elContentEdit.querySelector('[data-id="thumbnailWrapper"]'),this.elFormFieldAuthor=document.querySelector('[data-id="author"]'),this.elCkEditor=CKEDITOR.instances.fieldContent,this.elButtonRegister=this.elPage.querySelector("#btRegister"),this.isEdit=!1,this.editId=0,this.thumbnail="",this.thumbnailDefault="blog-thumbnail.jpg",this.pathImage="",this.pathThumbnail="dynamic/blog/thumbnail/"}validateForm(){const e=[this.elFormFieldTitle,this.elFormFieldUrl];return window.form.validateEmpty(e)}}export{AdminBlog};class AdminPage{build(){window.helper.getUrlWord("admin/page")&&(admin.setCKEditor(),this.update(),this.buildMenu(),this.buildMenuTable(),window.wbUrl.watch(this.elFormFieldTitle,this.elFormFieldUrl))}buildMenu(){this.elButtonRegister.onclick=(()=>{this.validateForm()&&(this.isEdit?this.editSave():this.saveContent())})}buildMenuTable(){const e=this.elContentList.querySelectorAll(".table"),t=this.elContentList.querySelectorAll('[data-id="tableActive"]'),i=this.elContentList.querySelectorAll('[data-id="tableInactive"]');Array.prototype.forEach.call(t,e=>{this.buildMenuTableActive(e)}),Array.prototype.forEach.call(i,e=>{this.buildMenuTableInactive(e)}),Array.prototype.forEach.call(e,e=>{this.buildMenuTableDefault(e)})}buildMenuTableActive(e){let t=e.querySelectorAll('[data-action="inactivate"]');Array.prototype.forEach.call(t,e=>{e.onclick=(()=>{window.modal.buildModal({kind:"confirmation",content:globalTranslation.confirmationInactivate,size:"small",click:`window.adminPage.modify(${e.getAttribute("data-id")}, "inactivate")`})})})}buildMenuTableInactive(e){let t=e.querySelectorAll('[data-action="activate"]');Array.prototype.forEach.call(t,e=>{e.onclick=(()=>{this.modify(e.getAttribute("data-id"),"activate")})})}buildMenuTableDefault(e){let t=e.querySelectorAll('[data-action="edit"]'),i=e.querySelectorAll('[data-action="delete"]');Array.prototype.forEach.call(t,e=>{e.onclick=(()=>{this.editId=e.getAttribute("data-id"),this.editLoadData(this.editId)})}),Array.prototype.forEach.call(i,e=>{e.onclick=(()=>{window.modal.buildModal({kind:"confirmation",content:globalTranslation.confirmationDelete,size:"small",click:`window.adminPage.delete(${e.getAttribute("data-id")})`})})})}buildParameter(){return`&title=${this.elFormFieldTitle.value}`+`&url=${this.elFormFieldUrl.value}`+`&menu=${this.elFormFieldMenu.value}`+`&content=${this.elCkEditor.getData()}`}delete(e){const t="&action=doDelete"+`&id=${e}`,i={controller:this.getController(),parameter:t};wbHelper.ajax(i).then(e=>{admin.showResponse(e)})}editSave(){const e="&action=doUpdate"+`&id=${this.editId}`+this.buildParameter(),t={controller:this.getController(),parameter:e};wbHelper.ajax(t).then(e=>{admin.showResponse(e)})}editLoadData(e){const t="&action=editLoadData"+`&id=${e}`,i={controller:this.getController(),parameter:t};wbHelper.ajax(i).then(e=>{this.editLoadDataSuccess(e)})}editLoadDataSuccess(e){let t=JSON.parse(e);document.documentElement.scrollTop=0,this.isEdit=!0,this.editFillField(t)}editFillField(e){this.elFormFieldTitle.value=e[`title_${globalLanguage}`],this.elFormFieldUrl.value=e[`url_${globalLanguage}`],this.elFormFieldMenu.value=e[`menu_${globalLanguage}`],this.editId=e.id,this.elCkEditor.setData(e[`content_${globalLanguage}`],()=>{this.elCkEditor.checkDirty()})}getController(){return wbUrl.getController({folder:"admin",file:"PageAjax"})}modify(e,t){const i="&action=doModify"+`&status=${t}`+`&id=${e}`,l={controller:this.getController(),parameter:i};wbHelper.ajax(l).then(e=>{admin.showResponse(e)})}saveContent(){const e="&action=doSave"+this.buildParameter(),t={controller:this.getController(),parameter:e};wbHelper.ajax(t).then(e=>{admin.showResponse(e)})}update(){this.elPage=document.querySelector("#pageAdminPageEdit"),this.elCkEditor=CKEDITOR.instances.fieldContent,this.elContentList=document.querySelector("#pageAdminPageList"),this.elFormFieldMenu=this.elPage.querySelector('[data-id="formFieldMenu"]'),this.elFormFieldTitle=this.elPage.querySelector('[data-id="formFieldTitle"]'),this.elFormFieldUrl=this.elPage.querySelector('[data-id="formFieldUrl"]'),this.elButtonRegister=this.elPage.querySelector("#btRegister"),this.isEdit=!1,this.editId=0}validateForm(){let e=[this.elFormFieldMenu,this.elFormFieldTitle];return window.form.validateEmpty(e)}}export{AdminPage};class AdminUploadImage{constructor(){this.deleteElement=""}build(){window.helper.getUrlWord("admin/image")&&(this.updateVariable(),this.buildMenu())}updateVariable(){this.elButtonUploadThumbnail=document.querySelector('[data-id="btUploadThumbnail"]'),this.elButtonUploadBanner=document.querySelector('[data-id="btUploadBanner"]')}buildMenu(){let e=document.querySelectorAll('[data-action="delete"]');this.elButtonUploadThumbnail.addEventListener("click",()=>{this.upload(this.elButtonUploadThumbnail,"blog/thumbnail/")}),this.elButtonUploadBanner.addEventListener("click",()=>{this.upload(this.elButtonUploadBanner,"blog/banner/")}),Array.prototype.forEach.call(e,e=>{e.onclick=(()=>{this.deleteImage(e)})})}deleteImage(e){this.deleteElement=e,window.modal.buildModal({kind:"confirmation",content:globalTranslation.confirmationDelete,size:"small",click:"window.adminUploadImage.deleteImageAjax()"})}deleteImageAjax(){const e=new FormData,t=new XMLHttpRequest,i=this.deleteElement.parentNode.parentNode.parentNode;let l=i.querySelector('[data-id="fileName"]').innerText,a=i.parentNode.parentNode.getAttribute("data-path"),o=i.parentNode.parentNode.parentNode.parentNode.parentNode;e.append("f",l),e.append("p",a),e.append("token",globalToken),t.open("POST",window.wbUrl.getController({folder:"admin",file:"ImageDelete"})),t.onreadystatechange=(()=>{4===t.readyState&&200===t.status&&(this.buildResponse(t.responseText,o),window.modal.closeModal())}),t.send(e)}upload(e,t){const i=e.parentNode.parentNode.parentNode.querySelector("[type=file]"),l=i.files[0],a=window.wbUrl.getController({folder:"admin",file:"ImageUpload"});let o=new FormData,n=new XMLHttpRequest;0!==i.files.length?(o.append("p",t),o.append("f",l),o.append("token",globalToken),this.elButtonUploadThumbnail.setAttribute("disabled","disabled"),n.open("POST",a),n.onreadystatechange=(()=>{4===n.readyState&&200===n.status&&this.uploadSuccess(n.responseText)}),n.send(o)):i.click()}uploadSuccess(e){this.elButtonUploadThumbnail.removeAttribute("disabled"),this.buildResponse(e)}buildResponse(e){let t;switch(e){case"fileDeleted":case"uploadDone":t="green",document.location.reload();break;default:t="red"}window.notification.add({text:globalTranslation[e],color:t})}}export{AdminUploadImage};class AdminUser{build(){window.helper.getUrlWord("admin/user")&&(this.updateVariable(),this.buildMenu())}buildParameter(){return`&name=${this.elFormFieldName.value}`+`&email=${this.elFormFieldEmail.value}`+`&permission=${this.elFormFieldPermission.value}`+`&password=${this.elFormFieldPassword.value}`}buildMenu(){let e=this.elPage.querySelectorAll(".table"),t=this.elPage.querySelectorAll('[data-id="tableActive"]'),i=this.elPage.querySelectorAll('[data-id="tableInactive"]');this.elFormSend.onclick=(()=>{this.validateForm()&&(this.isEdit?this.editSave():this.saveContent())}),Array.prototype.forEach.call(e,e=>{this.buildMenuEdit(e),this.buildMenuDelete(e)}),Array.prototype.forEach.call(t,e=>{this.buildMenuInactivate(e)}),Array.prototype.forEach.call(i,e=>{this.buildMenuActivate(e)})}buildMenuActivate(e){const t=e.querySelectorAll('[data-action="activate"]');Array.prototype.forEach.call(t,e=>{e.onclick=(()=>{this.modify(e.getAttribute("data-id"),"activate")})})}buildMenuInactivate(e){const t=e.querySelectorAll('[data-action="inactivate"]');Array.prototype.forEach.call(t,e=>{e.onclick=(()=>{window.modal.buildModal({kind:"confirmation",content:globalTranslation.confirmationInactivate,size:"small",click:`window.adminUser.modify(${e.getAttribute("data-id")}, 'inactivate')`})})})}buildMenuEdit(e){const t=e.querySelectorAll('[data-action="edit"]');Array.prototype.forEach.call(t,e=>{e.onclick=(()=>{this.editId=e.getAttribute("data-id"),this.editLoadData(this.editId)})})}buildMenuDelete(e){const t=e.querySelectorAll('[data-action="delete"]');Array.prototype.forEach.call(t,e=>{e.onclick=(()=>{window.modal.buildModal({kind:"confirmation",content:globalTranslation.confirmationDelete,size:"small",click:`window.adminUser.delete(${e.getAttribute("data-id")})`})})})}delete(e){const t="&action=doDelete"+`&id=${e}`,i={controller:this.getController(),parameter:t};wbHelper.ajax(i).then(e=>{admin.showResponse(e)})}editLoadData(e){const t="&action=editLoadData"+`&id=${e}`,i={controller:this.getController(),parameter:t};wbHelper.ajax(i).then(e=>{this.editLoadDataSuccess(e)})}editLoadDataSuccess(e){let t=JSON.parse(e);document.documentElement.scrollTop=0,this.editFillField(t)}editFillField(e){this.isEdit=!0,this.elFormFieldName.value=e.name,this.elFormFieldEmail.value=e.email,this.elFormFieldPassword.value="",this.editId=e.id,this.elFormFieldPermission.value=e.permission}editSave(){const e="&action=doUpdate"+`&id=${this.editId}`+this.buildParameter(),t={controller:this.getController(),parameter:e};wbHelper.ajax(t).then(e=>{admin.showResponse(e)})}getController(){return wbUrl.getController({folder:"admin",file:"UserAjax"})}modify(e,t){const i="&action=doModify"+`&status=${t}`+`&id=${e}`,l={controller:this.getController(),parameter:i};wbHelper.ajax(l).then(e=>{admin.showResponse(e)})}saveContent(){const e="&action=doSave"+this.buildParameter(),t={controller:this.getController(),parameter:e};wbHelper.ajax(t).then(e=>{admin.showResponse(e)})}updateVariable(){this.isEdit=!1,this.editId=0,this.elPage=document.querySelector("#pageAdminUser"),this.elForm=document.querySelector("#form"),this.elFormFieldName=document.querySelector("#form_name"),this.elFormFieldEmail=document.querySelector("#form_email"),this.elFormFieldPassword=document.querySelector("#form_password"),this.elFormFieldPermission=document.querySelector("#form_permission"),this.elFormSend=document.querySelector("#form_button_send")}validateForm(){let e=[this.elFormFieldEmail,this.elFormFieldPassword];return window.form.validateEmpty(e)}}export{AdminUser};class Login{build(){window.helper.getUrlWord("login")&&(this.update(),this.buildMenu())}update(){this.isSignUp=!1,this.elPage=document.querySelector("#pageAdminLogin"),this.elButtonLogin=document.querySelector("#pageAdminLoginBt"),this.elFieldLogin=document.querySelector("#pageAdminLoginUser"),this.elFieldPassword=document.querySelector("#pageAdminLoginPassword")}buildMenu(){this.elButtonLogin.addEventListener("click",()=>{this.buildLogin()})}validate(){const e=[this.elFieldLogin,this.elFieldPassword];if(window.FormData.validateEmpty(e))return!0}buildLogin(){const e={controller:wbUrl.getController({folder:"admin",file:"LoginAjax"}),parameter:`&email=${this.elFieldLogin.value}`+`&password=${this.elFieldPassword.value}`};wbHelper.ajax(e).then(e=>{this.buildLoginSuccess(e)})}buildLoginSuccess(e){let t="";switch(this.elButtonLogin.removeAttribute("disabled"),e){case"inactive":t=globalTranslation.loginInactive;break;case"problem":t=globalTranslation.loginFail,this.elFieldLogin.focus();break;case"empty_email":t=globalTranslation.emptyField,this.elFieldLogin.focus();break;case"empty_password":t=globalTranslation.emptyField,this.elFieldPassword.focus();break;default:wbUrl.buildUrl("admin")}window.notification.add({text:t,color:"red"})}}export{Login};window.adminUser=new AdminUser,window.adminBlog=new AdminBlog,window.adminPage=new AdminPage,window.adminUploadImage=new AdminUploadImage;const admin=new Admin,login=new Login;document.addEventListener("DOMContentLoaded",()=>{login.build(),admin.build(),adminBlog.build(),adminUploadImage.build(),adminUser.build(),adminPage.build()});