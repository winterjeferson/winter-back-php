class WbAdmin{constructor(){this.pageCurrent=""}build(){getUrlWord("admin")&&(this.updateVariable(),this.buildMenuDifeneActive(),this.builTableTdWrapper())}updateVariable(){this.$page=document.querySelector("#page_admin"),document.contains(this.$page)&&(this.$btBlog=this.$page.querySelector('[data-id="btBlog"]'),this.$btLogout=this.$page.querySelector('[data-id="btLogout"]'))}buildMenuChangePage(e){this.buildMenuDifeneActive(e),"admin-logout"!==e&&(window.location.href=e+"/")}buildMenuDifeneActive(){let e=window.location.href.split("/"),t=e[e.length-2],i=document.querySelector('#pageAdminBlog [data-id="'+t+'"]');null!==i&&i.parentNode.classList.add("menu-tab-active")}buildLogout(){let e=new XMLHttpRequest;e.open("POST",objWbUrl.getController(),!0),e.send("&c=WbLogin&m=doLogout")}builTableTdWrapper(){let e=document.querySelectorAll(".td-wrapper");Array.prototype.forEach.call(e,function(e){e.onclick=function(){e.classList.contains("td-wrapper-auto")?e.classList.remove("td-wrapper-auto"):e.classList.add("td-wrapper-auto")}})}}class WbAdminBlog{constructor(){}build(){getUrlWord("admin-blog")&&(CKEDITOR.replace("fieldContentPt",{entities:!1}),CKEDITOR.replace("fieldContentEn",{entities:!1}),CKEDITOR.replace("fieldContentPt"),CKEDITOR.replace("fieldContentEn"),this.updateVariable(),this.buildMenu(),this.buildMenuTable(),this.buildMenuThumbnail(),this.watchTitle())}updateVariable(){this.isEdit=!1,this.editId=0,this.$page=document.querySelector("#pageAdminBlog"),this.$contentEdit=document.querySelector("#pageAdminBlogEdit"),this.$contentEditThumbnail=this.$contentEdit.querySelector('[data-id="thumbnailWrapper"]'),this.$contentList=document.querySelector("#pageAdminBlogList"),this.$formRegister=this.$contentEdit.querySelector('[data-id="formRegister"]'),this.$formFieldTitlePt=this.$contentEdit.querySelector('[data-id="fieldTitlePt"]'),this.$formFieldTitleEn=this.$contentEdit.querySelector('[data-id="fieldTitleEn"]'),this.$formFieldUrlPt=this.$contentEdit.querySelector('[data-id="fieldUrlPt"]'),this.$formFieldUrlEn=this.$contentEdit.querySelector('[data-id="fieldUrlEn"]'),this.$formFieldContentPt=this.$contentEdit.querySelector('[data-id="fieldContentPt"]'),this.$formFieldContentEn=this.$contentEdit.querySelector('[data-id="fieldContentEn"]'),this.$formFieldTagPt=this.$contentEdit.querySelector('[data-id="fieldTagPt"]'),this.$formFieldTagEn=this.$contentEdit.querySelector('[data-id="fieldTagEn"]'),this.$formFieldDatePostPt=this.$contentEdit.querySelector('[data-id="fieldDatePostPt"]'),this.$formFieldDatePostEn=this.$contentEdit.querySelector('[data-id="fieldDatePostEn"]'),this.$formFieldDateEditPt=this.$contentEdit.querySelector('[data-id="fieldDateEditPt"]'),this.$formFieldDateEditEn=this.$contentEdit.querySelector('[data-id="fieldDateEditEn"]'),this.$formFieldTagEn=this.$contentEdit.querySelector('[data-id="fieldTagEn"]'),this.$thumbnailWrapper=this.$contentEdit.querySelector('[data-id="thumbnailWrapper"]'),this.thumbnail="",this.thumbnailDefault="default.jpg",this.thumbnailPath="assets/img/blog/thumbnail/",this.$ckEditorPt=CKEDITOR.instances.fieldContentPt,this.$ckEditorEn=CKEDITOR.instances.fieldContentEn}buildMenu(){const e=this;this.$page.querySelector('[data-id="btRegister"]').onclick=function(){e.isEdit?e.editSave():e.saveContent()}}buildMenuThumbnail(){const e=this.$contentEditThumbnail.querySelectorAll(".table");Array.prototype.forEach.call(e,function(e){let t=e.querySelectorAll('[data-action="edit"]');Array.prototype.forEach.call(t,function(e){e.onclick=function(){objWfModal.buildModal("ajax","./admin-upload-image-list.php","eb")}})})}buildMenuTable(){let e=this,t=this.$contentList.querySelectorAll(".table"),i=this.$contentList.querySelectorAll('[data-id="tableActive"]'),o=this.$contentList.querySelectorAll('[data-id="tableInactive"]');Array.prototype.forEach.call(i,function(e){let t=e.querySelectorAll('[data-action="inactivate"]');Array.prototype.forEach.call(t,function(e){e.onclick=function(){objWfModal.buildModal("confirmation",globalTranslation.confirmationInactivate),objWfModal.buildContentConfirmationAction("objWbAdminBlog.modify("+e.getAttribute("data-id")+', "inactivate")')}})}),Array.prototype.forEach.call(o,function(t){let i=t.querySelectorAll('[data-action="activate"]');Array.prototype.forEach.call(i,function(t){t.onclick=function(){e.modify(t.getAttribute("data-id"),"activate")}})}),Array.prototype.forEach.call(t,function(t){let i=t.querySelectorAll('[data-action="edit"]'),o=t.querySelectorAll('[data-action="delete"]');Array.prototype.forEach.call(i,function(t){t.onclick=function(){e.editId=t.getAttribute("data-id"),e.editLoadData(e.editId)}}),Array.prototype.forEach.call(o,function(e){e.onclick=function(){objWfModal.buildModal("confirmation",globalTranslation.confirmationDelete),objWfModal.buildContentConfirmationAction("objWbAdminBlog.delete("+e.getAttribute("data-id")+")")}})})}editSave(){let e=this,t=new XMLHttpRequest,i=objWbUrl.getController(),o="&c=WbAdminBlog&m=doUpdate&id="+e.editId+this.buildParameter();this.validateForm()&&(t.open("POST",i,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e.showResponse(t.responseText)},t.send(o))}editLoadData(e){let t=this,i=new XMLHttpRequest,o=objWbUrl.getController(),a="&c=WbAdminBlog&m=editLoadData&id="+e;i.open("POST",o,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){let e=JSON.parse(i.responseText);document.documentElement.scrollTop=0,t.isEdit=!0,t.editFillField(e),t.thumbnail=e.thumbnail,t.modifyThumbnail()}},i.send(a)}editFillField(e){this.$formFieldTitlePt.value=e.title_pt,this.$formFieldTitleEn.value=e.title_en,this.$formFieldUrlPt.value=e.url_pt,this.$formFieldUrlEn.value=e.url_en,this.$formFieldTagPt.value=e.tag_pt,this.$formFieldTagEn.value=e.tag_en,this.$formFieldDatePostPt.value=e.date_post_pt.substring(0,10),this.$formFieldDatePostEn.value=e.date_post_en.substring(0,10),this.$formFieldDateEditPt.value=e.date_edit_pt.substring(0,10),this.$formFieldDateEditEn.value=e.date_edit_en.substring(0,10),this.editId=e.id,this.$formFieldTagEn.value=e.tag_en,this.$ckEditorPt.setData(e.content_pt,function(){this.checkDirty()}),this.$ckEditorEn.setData(e.content_en,function(){this.checkDirty()})}modify(e,t){let i=this,o=new XMLHttpRequest,a=objWbUrl.getController(),n="&c=WbAdminBlog&m=doModify&status="+t+"&id="+e;o.open("POST",a,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){4==o.readyState&&200==o.status&&i.showResponse(o.responseText)},o.send(n)}delete(e){let t=this,i=new XMLHttpRequest,o=objWbUrl.getController(),a="&c=WbAdminBlog&m=doDelete&id="+e;i.open("POST",o,!0),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&t.showResponse(i.responseText)},i.send(a)}validateForm(){let e=[this.$formFieldTitlePt,this.$formFieldTitleEn,this.$formFieldUrlPt,this.$formFieldUrlEn];return objWfForm.validateEmpty(e)}buildParameter(){return"&titlePt="+this.$formFieldTitlePt.value+"&titleEn="+this.$formFieldTitleEn.value+"&urlPt="+this.$formFieldUrlPt.value+"&urlEn="+this.$formFieldUrlEn.value+"&contentPt="+this.$ckEditorPt.getData()+"&contentEn="+this.$ckEditorEn.getData()+"&datePostPt="+this.$formFieldDatePostPt.value+"&datePostEn="+this.$formFieldDatePostEn.value+"&dateEditPt="+this.$formFieldDateEditPt.value+"&dateEditEn="+this.$formFieldDateEditEn.value+"&thumbnail="+this.thumbnail+"&tagPt="+this.$formFieldTagPt.value+"&tagEn="+this.$formFieldTagEn.value}saveContent(){let e=this;if(!this.validateForm())return;let t=new XMLHttpRequest,i=objWbUrl.getController(),o="&c=WbAdminBlog&m=doSave"+this.buildParameter();t.open("POST",i,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4==t.readyState&&200==t.status&&e.showResponse(t.responseText)},t.send(o)}showResponse(e){let t="",i="";switch(e){case"1":location.reload();break;default:t="red",i="Acorreu um erro. Contate o administrador."}objWfNotification.add(i,t)}watchTitle(){let e=this;this.$formFieldTitlePt.addEventListener("focusout",function(){let t=objWbUrl.buildSEO(e.$formFieldTitlePt.value);e.$formFieldUrlPt.value=t}),this.$formFieldTitleEn.addEventListener("focusout",function(){let t=objWbUrl.buildSEO(e.$formFieldTitleEn.value);e.$formFieldUrlEn.value=t})}selectImage(e){let t=e.parentNode.parentNode.parentNode.parentNode.querySelector("header").querySelector('[data-id="imageName"]').innerText;this.thumbnail=t,objWfModal.closeModal(),this.modifyThumbnail()}modifyThumbnail(){let e=this.$thumbnailWrapper.querySelector("table").querySelector('[data-id="thumbnail"]'),t=this.$thumbnailWrapper.querySelector("table").querySelector('[data-id="name"]');""!==this.thumbnail&&null!==this.thumbnail||(this.thumbnail=this.thumbnailDefault),e.setAttribute("src",this.thumbnailPath+this.thumbnail),t.innerHTML=this.thumbnail}}class WbAdminUploadImage{constructor(){this.deleteElement=""}build(){getUrlWord("admin-upload-image")&&(this.updateVariable(),this.buildMenu())}updateVariable(){this.$btUploadThumbnail=document.querySelector('[data-id="btUploadThumbnail"]'),this.$btUploadBanner=document.querySelector('[data-id="btUploadBanner"]')}buildMenu(){const e=this;let t=document.querySelectorAll('[data-action="delete"]');this.$btUploadThumbnail.addEventListener("click",function(t){e.upload(this,"blog/thumbnail/")}),this.$btUploadBanner.addEventListener("click",function(t){e.upload(this,"blog/banner/")}),Array.prototype.forEach.call(t,function(t){t.onclick=function(){e.deleteImage(t)}})}deleteImage(e){this.deleteElement=e,objWfModal.buildModal("confirmation",globalTranslation.confirmationDelete),objWfModal.buildContentConfirmationAction("objWbAdminUploadImage.deleteImageAjax()")}deleteImageAjax(){const e=this,t=new FormData,i=new XMLHttpRequest;let o=this.deleteElement.parentNode.parentNode.parentNode.parentNode.parentNode.querySelector('[data-id="fileName"]').innerText,a=this.deleteElement.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.getAttribute("data-path"),n=this.deleteElement.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;t.append("c","WbAdminUploadImage"),t.append("m","delete"),t.append("f",o),t.append("p",a),i.open("POST",objWbUrl.getController()),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&(e.buildResponse(i.responseText,n),objWfModal.closeModal())},i.send(t)}upload(e,t){const i=this,o=e.parentNode.parentNode.parentNode.parentNode.parentNode,a=o.querySelector("[type=file]"),n=new FormData,l=new XMLHttpRequest,d=a.files[0],r=objWbUrl.getController();0!==a.files.length?(n.append("c","WbAdminUploadImage"),n.append("m","upload"),n.append("p",t),n.append("f",d),this.$btUploadThumbnail.setAttribute("disabled","disabled"),l.open("POST",r),l.onreadystatechange=function(){4==l.readyState&&200==l.status&&(i.$btUploadThumbnail.removeAttribute("disabled"),i.buildResponse(l.responseText,o))},l.send(n)):a.click()}buildResponse(e,t){switch(e){case"fileDeleted":case"uploadDone":objWfNotification.add(globalTranslation[e],"green",t),document.location.reload();break;default:objWfNotification.add(globalTranslation[e],"red",t)}}}class WbBlog{constructor(){this.classlaodMore="loadMore"}build(){getUrlWord("blog")&&(this.update(),this.buildMenu())}update(){this.page="pageBlog",this.$lastPost=document.querySelector("#"+this.page+"LastPost"),this.$mostViewed=document.querySelector("#"+this.page+"MostViewed")}buildMenu(){let e=this;this.$lastPost&&(document.contains(this.$lastPost.querySelector('[data-id="'+this.classlaodMore+'"]'))&&this.$lastPost.querySelector('[data-id="'+this.classlaodMore+'"]').addEventListener("click",function(t){e.loadMore(this)}),document.contains(this.$mostViewed.querySelector('[data-id="'+this.classlaodMore+'"]'))&&this.$mostViewed.querySelector('[data-id="'+this.classlaodMore+'"]').addEventListener("click",function(t){e.loadMore(this)}))}loadMore(e){let t=this,i=e.parentNode.parentNode.parentNode.getAttribute("id"),o=i.substring(this.page.length),a=new XMLHttpRequest,n=objWbUrl.getController(),l="&c=WbBlogList&m=buildLoadMoreButtonClick&target="+o;e.classList.add("disabled"),a.open("POST",n,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){4==a.readyState&&200==a.status&&(e.classList.remove("disabled"),t.loadMoreSuccess(i,a.responseText))},a.send(l)}loadMoreSuccess(e,t){let i=JSON.parse(t),o=document.querySelector("#"+e),a=o.querySelector(".blog-list"),n=o.querySelector('[data-id="'+this.classlaodMore+'"]');i[this.classlaodMore]||n.classList.add("disabled"),a.insertAdjacentHTML("beforeend",i.html),window.scrollTo(0,document.documentElement.scrollTop+1),window.scrollTo(0,document.documentElement.scrollTop-1)}}class WbForm{constructor(){}build(){getUrlWord("form")&&(this.update(),this.buildMenu())}update(){this.$page=document.querySelector("#pageForm"),this.$form=this.$page.querySelector(".form"),this.$btSend=this.$page.querySelector("#pageFormBtSend")}buildMenu(){let e=this;this.$btSend.addEventListener("click",function(t){e.send()})}send(){let e=this,t=new XMLHttpRequest,i=objWbUrl.getController(),o="&c=WbForm&m=sendForm&d="+JSON.stringify(e.getData());this.$btSend.setAttribute("disabled","disabled"),t.open("POST",i,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4==t.readyState&&200==t.status&&(e.$btSend.removeAttribute("disabled"),e.response(t.responseText))},t.send(o)}getData(){let e=[];return e.push(["text","text content"]),e.push(["textarea","textarea content"]),e}response(e){let t="",i="";switch(e){case"ok":i="green",t=globalTranslation.formSent;break;default:i="red",t=globalTranslation.formProblemSend}objWfNotification.add(t,i,this.$form)}}class WbLogin{constructor(){}build(){getUrlWord("admin-login")&&(this.update(),this.buildMenu())}update(){this.isSignUp=!1,this.$page=document.querySelector("#pageAdminLogin"),this.$buttonLogin=document.querySelector("#pageAdminLoginBt"),this.$fielEmail=document.querySelector("#pageAdminLoginUser"),this.$fieldPassword=document.querySelector("#pageAdminLoginPassword")}buildMenu(){let e=this;this.$buttonLogin.addEventListener("click",function(t){e.buildLogin()})}validate(){return""===this.$fielEmail.value?(this.$fielEmail.focus(),void this.buildLoginResponse("empty_email")):""!==this.$fieldPassword.value||(this.$fieldPassword.focus(),void this.buildLoginResponse("empty_password"))}buildLogin(){let e=this,t=new XMLHttpRequest,i=objWbUrl.getController(),o="&c=WbLogin&m=doLogin&email="+this.$fielEmail.value+"&password="+this.$fieldPassword.value;this.validate()&&(this.$buttonLogin.setAttribute("disabled","disabled"),t.open("POST",i,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4==t.readyState&&200==t.status&&(e.$buttonLogin.removeAttribute("disabled"),e.buildLoginResponse(t.responseText))},t.send(o))}buildLoginResponse(e){let t="",i=this.$page.querySelector(".form");switch(e){case"inactive":t=globalTranslation.login_inactive;break;case"problem":t=globalTranslation.login_fail,this.$fielEmail.focus();break;case"empty_email":t=globalTranslation.empty_field,this.$fielEmail.focus();break;case"empty_password":t=globalTranslation.empty_field,this.$fieldPassword.focus();break;default:objWbUrl.build("admin")}objWfNotification.add(t,"red",i)}}class WbManagement{verifyLoad(){window.addEventListener("load",this.applyClass(),{once:!0})}applyClass(){objWbTranslation.build(),objWbLogin.build(),objWbAdmin.build(),objWbAdminBlog.build(),objWbAdminUploadImage.build(),objWbBlog.build(),objWbForm.build()}}class WbTranslation{constructor(){}build(){this.update(),this.defineActive(),this.buildMenu()}buildMenu(){let e=this;this.$select.addEventListener("change",function(t){e.change(this.value)})}change(e){let t=new XMLHttpRequest,i=objWbUrl.getController(),o="&c=WbTranslation&m=change&language="+e;t.open("POST",i,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4==t.readyState&&200==t.status&&location.reload()},t.send(o)}defineActive(){this.$select.value=globalLanguage}update(){this.$select=document.querySelector("#translationSelect")}}class WbUrl{constructor(){}buildSEO(e){return e.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"-").toLowerCase().replace(/&/g,"-and-").replace(/[^a-z0-9\-]/g,"").replace(/-+/g,"-").replace(/^-*/,"").replace(/-*$/,"")}build(e){return window.location=globalUrl+globalLanguage+"/"+e+"/"}getController(){return globalUrl+"assets/php/controller.php"}}var objWbAdmin=new WbAdmin,objWbAdminBlog=new WbAdminBlog,objWbAdminUploadImage=new WbAdminUploadImage,objWbBlog=new WbBlog,objWbForm=new WbForm,objWbLogin=new WbLogin,objWbManagement=new WbManagement,objWbTranslation=new WbTranslation,objWbUrl=new WbUrl;objWbManagement.verifyLoad();